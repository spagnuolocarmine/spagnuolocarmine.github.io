<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Open-Source Serverless Architecture Project | Carmine Spagnuolo</title> <meta name="author" content="Carmine Spagnuolo"> <meta name="description" content="The personal homepage of Carmine Spagnuolo. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9B%B5&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://spagnuolocarmine.github.io/blog/2019/serverless/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Carmine </span>Spagnuolo</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">students</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/teaching/">teaching</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/thesis/">thesis</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Open-Source Serverless Architecture Project</h1> <p class="post-meta">January 31, 2019</p> <p class="post-tags"> <a href="/blog/2019"> <i class="fas fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/category/project"> <i class="fas fa-tag fa-sm"></i> project</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <script async="" defer src="https://buttons.github.io/buttons.js"></script> <h1 id="serverless-computing-for-iot">Serverless Computing for IoT</h1> <p>Serverless computing is a cloud-computing execution model in which the cloud provider acts as the server, dynamically managing the allocation of machine resources. Serverless Computing exploits Function as a service (FaaS) that is a category of cloud computing services that provides a platform allowing customers to develop, run, and manage application functionalities without the complexity of building and maintaining the infrastructure typically associated with developing and launching an app.Building an application following this model is one way of achieving a “serverless” architecture, and is typically used when building microservices applications.</p> <p>The Internet of things (IoT) is the network of physical devices, vehicles, home appliances, and other items embedded with electronics, software, sensors, actuators, and connectivity which enables these things to connect, collect and exchange data.</p> <p>We are interest to efficiently collect and elaborate this data, and produce new data as answer to particular condition computed from the data received. Cloud architectures provides an efficient methods to build this kind of applications.</p> <p align="center"><img src="https://github.com/spagnuolocarmine/serverless-computing-for-iot/blob/master/assets/iot-architecture.png?raw=true" width="1000"></p> <h4 id="tutorial-structure">Tutorial Structure</h4> <ul> <li><strong><a href="#audience">Audience</a></strong></li> <li><strong><a href="#prerequisites">Prerequisites</a></strong></li> <li><strong><a href="#installation">Installation</a></strong></li> <li><strong><a href="#examples">Examples</a></strong></li> </ul> <h2 id="audience">Audience</h2> <p>This tutorial is designed for building a computing architecture, based on open-source software, that allows the users to exploit Function-as-service model in the context of IoT. The idea is provides a system which allows as in Amazon Aws or Microsoft Azure, and so on, to deploy functions that are trigged by events generated from small devices such as sensors and mobile (IoT devices), commonly these devices communicates using message-passing, in particular on dedicated protocols as AMQP or MQTT.</p> <p>The end of this tutorial provides example that deploy a function able to log the temperature value received by a sensor on the AMQP protocol, in this example the events are generated by another function executed on the system or outside (this is a semplification, but it is easily to test using a real device that allows to send messages on AMQP protocol).</p> <h2 id="prerequisites">Prerequisites</h2> <ul> <li>OS: <ul> <li>Ubuntu 18.04 LTS</li> </ul> </li> <li>Software: <ul> <li>Docker and Docker Compose (Application containers engine)</li> <li>Nuclio (Serverless computing provider)</li> <li>RabbitMQ (AMQP and MQTT message broker)</li> <li>Node.js</li> </ul> </li> </ul> <h2 id="installation">Installation</h2> <p>This tutorial is made on top of one local machine an Linux Ubuntu 18.04 LTS machine.</p> <h3 id="docker">Docker</h3> <p>Docker is a tool designed to make it easier to create, deploy, and run applications by using containers. Containers allow a developer to package up an application with all of the parts it needs, such as libraries and other dependencies, and ship it all out as one package. By doing so, thanks to the container, the developer can rest assured that the application will run on any other Linux machine regardless of any customized settings that machine might have that could differ from the machine used for writing and testing the code.</p> <p>In a way, Docker is a bit like a virtual machine. But unlike a virtual machine, rather than creating a whole virtual operating system, Docker allows applications to use the same Linux kernel as the system that they’re running on and only requires applications be shipped with things not already running on the host computer. This gives a significant performance boost and reduces the size of the application.</p> <p><strong>TIP</strong> Docker is used in the architecture to deploy the function in an application container, each function is a Docker container that is listening on a socket port and can be invoked by an HTTP request, or by other triggers.</p> <p>Install Docker using the Docker CE installation <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/#extra-steps-for-aufs" rel="external nofollow noopener" target="_blank">guide</a>.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt-get update
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="se">\</span>
    apt-transport-https <span class="se">\</span>
    ca-certificates <span class="se">\</span>
    curl <span class="se">\</span>
    software-properties-common
<span class="nv">$ </span>curl <span class="nt">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg | <span class="nb">sudo </span>apt-key add -
<span class="nv">$ </span><span class="nb">sudo </span>apt-key fingerprint 0EBFCD88
<span class="nv">$ </span><span class="nb">sudo </span>add-apt-repository <span class="se">\</span>
   <span class="s2">"deb [arch=amd64] https://download.docker.com/linux/ubuntu </span><span class="se">\</span><span class="s2">
   </span><span class="si">$(</span>lsb_release <span class="nt">-cs</span><span class="si">)</span><span class="s2"> </span><span class="se">\</span><span class="s2">
   stable"</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get update
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>docker-ce
</code></pre></div></div> <p><strong>IMPORTANT FIX</strong> Ubuntu 18.04 changed to use systemd-resolved to generate /etc/resolv.conf. Now by default it uses a local DNS cache 127.0.0.53. That will not work inside a container, so Docker will default to Google’s 8.8.8.8 DNS server, which may break for people behind a firewall. Refers to the <a href="https://stackoverflow.com/questions/20430371/my-docker-container-has-no-internet" rel="external nofollow noopener" target="_blank">Stackoverflow discussion</a>.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo ln</span> <span class="nt">-sf</span> /run/systemd/resolve/resolv.conf /etc/resolv.conf
</code></pre></div></div> <hr> <h3 id="docker-compose">Docker Compose</h3> <p>Compose is a tool for defining and running multi-container Docker applications. With Compose, you use a YAML file to configure your application’s services.</p> <p><strong>TIP</strong> Docker compose is the technology used by Nuclio to easily create, build and deploy Docker application containers (the functions in this case).</p> <p>Install Docker Compose using the Docker Compose installation <a href="https://docs.docker.com/compose/install/#install-compose" rel="external nofollow noopener" target="_blank">guide</a>.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>curl <span class="nt">-L</span> <span class="s2">"https://github.com/docker/compose/releases/download/1.22.0/docker-compose-</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-s</span><span class="si">)</span><span class="s2">-</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span><span class="s2">"</span> <span class="nt">-o</span> /usr/local/bin/docker-compose
<span class="nv">$ </span><span class="nb">sudo chmod</span> +x /usr/local/bin/docker-compose
</code></pre></div></div> <hr> <h3 id="nuclio">Nuclio</h3> <p>Nuclio (High-Performance Serverless event and data processing platform) is a new “serverless” project, derived from Iguazio’s elastic data life-cycle management service for high-performance events and data processing. The simplest way to explore Nuclio is to run its graphical user interface (GUI) of the Nuclio dashboard.</p> <p><strong>TIP</strong> The Nuclio documentation is available at <a href="https://nuclio.io/docs/latest/" rel="external nofollow noopener" target="_blank">this link</a>.</p> <p>Start <a href="https://github.com/nuclio/nuclio" rel="external nofollow noopener" target="_blank">Nuclio</a> using a docker container.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">-p</span> 8070:8070 <span class="nt">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="nt">-v</span> /tmp:/tmp nuclio/dashboard:stable-amd64
</code></pre></div></div> <p>Browse to http://localhost:8070, create a project, and add a function. When run outside of an orchestration platform (for example, Kubernetes or Swarm), the dashboard will simply deploy to the local Docker daemon.</p> <p><strong>TIP</strong> Nuclio provide also the nctcl application client that allows to basically execute the same operation of Nuclio dashboard.</p> <hr> <h3 id="rabbitmq">RabbitMQ</h3> <p>RabbitMQ is lightweight and easy to deploy on premises and in the cloud. It supports multiple messaging protocols. RabbitMQ can be deployed in distributed and federated configurations to meet high-scale, high-availability requirements.</p> <p>Start <a href="https://www.rabbitmq.com" rel="external nofollow noopener" target="_blank">RabbitMQ</a> instance with MQTT enabled using docker.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker run <span class="nt">-p</span> 9000:15672  <span class="nt">-p</span> 1883:1883 <span class="nt">-p</span> 5672:5672  cyrilix/rabbitmq-mqtt 
</code></pre></div></div> <p>Browse to http://localhost:9000, and login using username: guest and password: guest, to access to the RabbitMQ managment, where is possible to visualize the message queues and the broker status.</p> <hr> <h4 id="library-for-amqp-and-mqtt-clients">Library for AMQP and MQTT clients</h4> <p>There are different libraries for many languages for interacting with protocol AMQP and MQTT you can use what you want. For JavScript AMQP we used this <a href="https://github.com/squaremo/amqp.node" rel="external nofollow noopener" target="_blank">library</a>, while for JavaScript MQTT we used this <a href="https://github.com/mqttjs/MQTT.js" rel="external nofollow noopener" target="_blank">library</a>.</p> <h2 id="examples">Examples</h2> <ul> <li><a href="https://github.com/spagnuolocarmine/serverless-computing-for-iot/blob/master/iot/amqp/temperature" rel="external nofollow noopener" target="_blank">Temperature using AMQP</a></li> <li><a href="https://github.com/spagnuolocarmine/serverless-computing-for-iot/blob/master/iot/mqtt/temperature" rel="external nofollow noopener" target="_blank">Temperature using MQTT</a></li> </ul> <h3 id="mqtt-android-clients">MQTT Android Clients</h3> <p>We used a general purpose <a href="https://play.google.com/store/apps/details?id=in.dc297.mqttclpro" rel="external nofollow noopener" target="_blank">MQTT client</a> for Android.</p> <hr> <h2 id="docker-tips">Docker TIPS</h2> <p>In this section are presentented several Docker useful commands:</p> <ul> <li>Docker container ID: <code class="language-plaintext highlighter-rouge">sudo docker ps -a</code>, displays all deployed containers, rember that functions are Docker containers, the IMAGE field is the function name and version, while the CONTAINER ID is the ID of the function. In this view is also possible to see the listening port for the function in the field PORTS.</li> <li>Docker Logs: <code class="language-plaintext highlighter-rouge">sudo docker logs CONTAINER ID</code>, displays the STDOUT and STDERR of the associated container.</li> <li>Docker Kill: <code class="language-plaintext highlighter-rouge">sudo docker kill CONTAINER ID</code>, kills the associated container.</li> <li>Docker Remove: <code class="language-plaintext highlighter-rouge">sudo docker rm CONTAINER ID</code>, removes the associated container.</li> </ul> <hr> <p><a class="github-button" href="https://github.com/spagnuolocarmine/serverless-computing-for-iot/archive/master.zip" data-icon="octicon-cloud-download" data-size="large" aria-label="Download spagnuolocarmine/serverless-computing-for-iot on GitHub" rel="external nofollow noopener" target="_blank">Download</a> <a class="github-button" href="https://github.com/spagnuolocarmine/serverless-computing-for-iot" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star spagnuolocarmine/serverless-computing-for-iot on GitHub" rel="external nofollow noopener" target="_blank">Star</a></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/adc/">Architetture Distribuite per il Cloud (ADC) @ Università degli Studi di Salerno</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/sof/">Simulation Optimization Framework Project</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/ubunut-openmpi-openmp/">Ubunutu machine with OpenMPI and OpenMP</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/dmason/">DMASON Project</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/mpi-example1/">MPI Find Max Example</a> </li> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Carmine Spagnuolo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: February 28, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>